<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Now Insite</title>
  <meta name="description" content="AI Now Insite는 현재의 AI 기술과 관련 흐름을 정리해 소개하는 정보형 웹사이트입니다." />
  <link rel="canonical" href="https://ainowinsight.com/" />
  <link rel="stylesheet" href="/assets/site.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">
        <h1>AI Now Insite</h1>
        <p>현재의 AI 기술과 그 흐름을 정리해 살펴볼 수 있는 공간입니다.</p>
      </div>
      <nav class="nav">
        <a href="/about.html">소개</a>
        <a href="/privacy.html">개인정보처리방침</a>
        <a href="/terms.html">이용약관</a>
        <a href="/contact.html">문의</a>
      </nav>
    </header>

    <section class="hero">
      <div class="card">
        <div class="h2">최신 글</div>
        <div class="meta">
         글은 정보형 콘텐츠로 작성되며, 필요에 따라 내용이 보완될 수 있습니다.
        </div>
        <hr />
        <ul class="list">
          <!-- POSTS:START -->
          <!-- POSTS:END -->
        </ul>

        <div class="small" style="margin-top:12px">
          최신 글이 바로 안 보이면 주소 끝에 <span class="code">?v=숫자</span>를 붙여 새로고침 해보세요.
        </div>
      </div>
    </section>

    <footer class="footer">
      © AI Now Insite · <span class="meta">ainowinsight.com</span>
    </footer>
  </div>
  <script>
  (function(){
    var list = document.querySelector('ul.list');
    if(!list) return;
    var hasItems = Array.from(list.children).some(function(el){ return el.tagName === 'LI'; });
    if(hasItems) return;

    var host = location.hostname || '';
    var owner = (host.endsWith('.github.io') ? host.split('.')[0] : 'ilovegkd');
    var repo = owner + '.github.io';
    var branches = ['main','master'];

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, function(c){
        return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c];
      });
    }
    function pickTitle(md, fallback){
      var m = md.match(/^\s*#\s+(.+)\s*$/m);
      return (m && m[1]) ? m[1].trim() : fallback;
    }
    function pickImage(md){
      var m = md.match(/!\[[^\]]*\]\(([^)]+)\)/);
      return (m && m[1]) ? m[1].trim().replace(/^[\"']|[\"']$/g,'') : '';
    }

    function listMdFiles(branch){
      var api = 'https://api.github.com/repos/' + owner + '/' + repo + '/contents?ref=' + branch;
      return fetch(api, {cache:'no-store'}).then(function(res){
        if(!res.ok) throw new Error('HTTP ' + res.status);
        return res.json();
      }).then(function(items){
        var md = (items || []).filter(function(it){
          return it && it.type === 'file' && typeof it.name === 'string' &&
            it.name.toLowerCase().endsWith('.md') && it.name.toLowerCase() !== 'readme.md';
        });
        md.sort(function(a,b){ return (b.name||'').localeCompare(a.name||''); });
        return md.slice(0, 30);
      });
    }

    function fetchMdRaw(path, branch){
      var raw = 'https://raw.githubusercontent.com/' + owner + '/' + repo + '/' + branch + '/' + path + '?v=' + Date.now();
      return fetch(raw, {cache:'no-store'}).then(function(res){
        if(!res.ok) throw new Error('HTTP ' + res.status);
        return res.text();
      });
    }

    function render(posts){
      if(!posts.length){
        list.innerHTML = '<li class="meta">아직 홈에 노출할 글이 없습니다.</li>';
        return;
      }
      list.innerHTML = posts.map(function(p){
        var title = escapeHtml(p.title || 'Untitled');
        var url = escapeHtml(p.url || '#');
        var img = p.image ? '<img src="'+escapeHtml(p.image)+'" alt="" loading="lazy" class="post-thumb" />' : '';
        var date = p.date ? '<div class="small meta">'+escapeHtml(p.date)+'</div>' : '';
        return (
          '<li class="post-item">' +
            img +
            '<div class="post-text">' +
              '<a class="post-link" href="'+url+'">'+title+'</a>' +
              date +
            '</div>' +
          '</li>'
        );
      }).join('');
    }

    (function tryBranch(i){
      if(i >= branches.length){
        list.innerHTML = '<li class="meta">글 목록을 불러오지 못했습니다. (브랜치/main·master 확인 필요)</li>';
        return;
      }
      var branch = branches[i];
      listMdFiles(branch).then(function(files){
        if(!files.length){ render([]); return; }

        var limit = Math.min(files.length, 12);
        var tasks = files.slice(0, limit).map(function(f){
          var base = f.name.replace(/\.md$/i,'');
          return fetchMdRaw(f.path, branch).then(function(md){
            var title = pickTitle(md, base);
            var image = pickImage(md);
            var date = '';
            var dm = base.match(/^(\d{4}-\d{2}-\d{2}|\d{8})/);
            if(dm) date = dm[1];
            return { title:title, url:'/' + base + '.html', image:image, date:date };
          }).catch(function(){
            return { title:base, url:'/' + base + '.html', image:'', date:'' };
          });
        });

        Promise.all(tasks).then(render);
      }).catch(function(){
        tryBranch(i+1);
      });
    })(0);
  })();
  </script>

</body>
</html>
